<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Certificaciones</title>
  <link rel="stylesheet" href="estilos.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="media/FaviconCodeVerse.png">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <nav class="navbar">
    <div class="nav-left">
      <a href="index.html" class="nav-logo">CodeVerse</a>
      <a href="index.html" class="nav-link">Inicio</a>
      <a href="certificaciones.html" class="nav-link active">Certificaciones</a>
      <a href="nosotros.html" class="nav-link">Nosotros</a>
      <a href="contacto.html" class="nav-link">Contacto</a>
    </div>
    <div class="nav-right">
      <span id="userName" class="user-name"></span>
      <button id="logoutBtn" class="icon-btn" style="display:none;"></button>
    </div>
  </nav>

  <main>
    <section>
      <h1>Certificaciones disponibles</h1>

      <div class="card">
        <h2>JavaScript Developer</h2>
        <p>Domina el lenguaje m谩s usado en el desarrollo web moderno.</p>
        <p>Duraci贸n: 15 minutos | Costo: $500 | M铆nimo: 70 puntos</p>
        <button onclick="pagar()">Pagar</button>
        <button onclick="iniciarExamen()">Iniciar Examen</button>
      </div>

      <div class="card deshabilitado">
        <h2>Phyton</h2>
        <p>Disponible a partir de Enero 2026.</p>
        <button disabled>Abonar</button>
        <button disabled>Pendiente</button>
      </div>

      <div class="card deshabilitado">
        <h2>Programaci贸n Web</h2>
        <p>Disponible en Marzo 2026.</p>
        <button disabled>Abonar</button>
        <button disabled>Pendiente</button>
      </div>

      <div class="card deshabilitado">
        <h2>Node.js Backend</h2>
        <p>Disponible en Junio 2026.</p>
        <button disabled>Abonar</button>
        <button disabled>Pendiente</button>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
  <script>
    async function pagar() {
      const token = localStorage.getItem("token");
      if (!token) {
        Swal.fire("Error", "Debes iniciar sesi贸n antes de pagar.", "error");
        return;
      }

      try {
        const res = await fetch("http://localhost:3000/api/pago", {
          method: "POST",
          headers: { Authorization: `Bearer ${token}` }
        });
        const data = await res.json();

        if (res.ok) {
          Swal.fire("xito", data.mensaje, "success");
        } else {
          Swal.fire("Atenci贸n", data.error, "info");
        }
      } catch (err) {
        Swal.fire("Error", "No se pudo conectar con el servidor.", "error");
      }
    }

    async function iniciarExamen() {
      const token = localStorage.getItem("token");
      if (!token) {
        Swal.fire("Error", "Debes iniciar sesi贸n primero.", "error");
        return;
      }

      try {
        const res = await fetch("http://localhost:3000/api/examen/start", {
          method: "POST",
          headers: { Authorization: `Bearer ${token}` }
        });

        const data = await res.json();

        if (res.ok) {
          // Guardamos temporalmente las preguntas para examen.html
          localStorage.setItem("examenActual", JSON.stringify(data.examen));
          window.location.href = "examen.html";
        } else {
          Swal.fire("Atenci贸n", data.error, "info");
        }
      } catch (err) {
        Swal.fire("Error", "No se pudo conectar con el servidor.", "error");
      }
    }
  </script>
  <!-- Footer -->
  <footer>
    <p>漏 2025 CodeVerse. Todos los derechos reservados.</p>
    <p>S铆guenos en nuestras redes:</p>
    <a href="https://www.facebook.com/share/1A6H8kAviS/?mibextid=wwXIfr" target="_blank">
      <img src="media/facebook.png" alt="Facebook">
    </a>
  </footer>
</body>
</html>
